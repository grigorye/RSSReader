<?xml version="1.0" encoding="UTF-8"?>
<!doctype html>
<html>
	<head>
		<style type="text/css">
			h2 {
				font: -apple-system-headline;
			}
			body {
				font: -apple-system-body;
				zoom: 1.2;
			}
			img {
				width: auto;
				height : auto;
				max-height: 100%;
				max-width: 100%;
			}
		</style>
	</head>
	<body>
		<h2>Swift Non-Nil Values In An Array Of Optionals</h2>
		<p>I find it hard to remember the different ways you can use <code>case</code> with Swift beyond the familiar <code>switch</code>. Here is one useful example for when you need to do something with the non-nil values in an array of optionals.</p> 
 
<p></p> 
 
<p>Here is the situation. I have an array of <code>String</code> items some of which can be <code>nil</code>.</p> 
 
<pre><code>let names = ["Tom", nil, "Fred"] 
</code></pre> 
 
<p>The type of names is <code>[String?]</code> - an array of optional strings. Suppose I want to do some operation on each of the non-nil values in the array:</p> 
 
<pre><code>func doSomething(_ name: String) { 
  print(name) 
} 
</code></pre> 
 
<p>My function wants a non-optional <code>String</code>. I can iterate over the array grabbing the non-nil values with an <code>if let</code>:</p> 
 
<pre><code>for name in names { 
  if let name = name { doSomething(name) } 
} 
// Tom 
// Fred 
</code></pre> 
 
<p>This is a good time to remember about <a href="https://useyourloaf.com/blog/swift-guide-to-map-filter-reduce/"><code>flatMap</code></a> to skip over the <code>nil</code> values:</p> 
 
<pre><code>for name in names.flatMap({ $0 }) { 
  doSomething(name) 
} 
// Tom 
// Fred 
</code></pre> 
 
<p>That is not bad but I like an alternate approach using <code>case</code> with <em>optional pattern matching</em>:</p> 
 
<pre><code>for case let name? in names { 
  doSomething(name) 
} 
// Tom 
// Fred 
</code></pre> 
 
<p>This works as optionals are an <code>enum</code> with two cases: <code>.none</code> and <code>.some(T)</code>. The optional pattern (<code>let name?</code>) is a shorthand for matching the <code>.some</code> case which we could write as follows:</p> 
 
<pre><code>for case .some(let name) in names { 
  doSomething(name) 
} 
</code></pre> 
 
<p>The pattern for matching <code>nil</code> elements would be this:</p> 
 
<pre><code>for case .none in names { 
  print("found nil") 
} 
</code></pre> 
 
<p>You need the <code>?</code> to make the pattern match optionals. So to match a specific value:</p> 
 
<pre><code>for case "Fred"? in names { 
  print("Found Fred") 
} 
</code></pre> 
 
<h3>Using <code>where</code> with <code>case</code></h3> 
 
<p>You can go one step further and add a <code>where</code> clause to act as filter on the array.</p> 
 
<pre><code>let scores = [1,5,8,3,10,nil,7] 
for case let score? in scores where score &gt; 6 { 
  print(score) 
} 
// 8 
// 10 
// 7 
</code></pre> 
 
<p>Which I prefer to playing around with flatMap to remove the nil values before applying a filter:</p> 
 
<pre><code>for score in scores.flatMap({ $0 }).filter({ $0 &gt; 6 }) { 
  print(score) 
} 
</code></pre> 
 
<h3>Related Posts</h3> 
 
<ul><li><a href="https://useyourloaf.com/blog/swift-guide-to-map-filter-reduce/">Swift Guide to Map Filter Reduce</a></li> 
</ul><hr><p> 
<a href="https://useyourloaf.com/blog/swift-non-nil-values-in-an-array-of-optionals/">Swift Non-Nil Values In An Array Of Optionals</a> was originally posted 08 Jan 2018 on <a href="https://useyourloaf.com">useyourloaf.com</a>. 
</p> 
<p>Want this direct to your inbox? <a href="https://useyourloaf.com/newsletter">Sign up</a> and get my free iOS Size Classes guide. 
</p> 
<hr>
	</body>
</html>
