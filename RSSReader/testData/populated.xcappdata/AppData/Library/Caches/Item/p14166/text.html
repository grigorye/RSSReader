<?xml version="1.0" encoding="UTF-8"?>
<!doctype html>
<html>
	<head>
		<style type="text/css">
			h2 {
				font: -apple-system-headline;
			}
			body {
				font: -apple-system-body;
				zoom: 1.2;
			}
			img {
				width: auto;
				height : auto;
				max-height: 100%;
				max-width: 100%;
			}
		</style>
	</head>
	<body>
		<h2>IOHIDeous: IOHIDFamily 0day</h2>
		<p><a href="https://siguza.github.io/IOHIDeous/">Siguza</a> (via <a href="https://twitter.com/patrickwardle/status/947935887995703297">Patrick Wardle</a>, <a href="https://news.ycombinator.com/item?id=16043578">Hacker News</a>):</p> 
<blockquote><p>This is the tale of a macOS-only vulnerability in IOHIDFamily that yields kernel r/w and can be exploited by any unprivileged user.</p><p>[…]</p><p>The thing is that between this line:</p><pre>eop-&gt;evGlobalsOffset = sizeof(EvOffsets);</pre> 
<p>and this one:</p> 
<pre>evg = (EvGlobals *)((char *)shmem_addr + eop-&gt;evGlobalsOffset);</pre><p>The value of <code>eop-&gt;evGlobalsOffset</code> can change, which will then cause <code>evg</code> to point to somewhere other than intended.</p> 
<p>From looking <a href="https://opensource.apple.com/source/IOHIDFamily/IOHIDFamily-33/IOHIDSystem/IOHIDSystem.cpp.auto.html">at the source</a>, this vulnerability seems to have been present at least since as far back as 2002.</p> 
</blockquote> 
 
<p><a href="https://twitter.com/s1guza/status/947840701559136256">Siguza</a>:</p> 
<blockquote><p>I would’ve submitted to Apple if their bug bounty included macOS, or if the vuln was remotely exploitable.</p></blockquote> 
 
<p><a href="https://news.ycombinator.com/item?id=16044125">Siguza</a>:</p> 
<blockquote><p>And an engineer from Apple’s security team contacted me a bit after releasing - they had found the bug a while ago, but hadn’t verified the subsequent patch which actually didn’t fix it. And a while ago I tweeted <a href="https://twitter.com/s1guza/status/921889566549831680">this</a> (try diff’ing sources to find it :P). So they do have people on it. I also told that person to extend my condolences to whoever has to come in and fix that now, but they basically said that there’s nothing to apologise for and that they (the team) really like such write-ups.</p></blockquote> 
 
<p>Previously: <a href="https://mjtsai.com/blog/2018/01/01/identityservicesd-what-if-anyone-can-be-you/">identityservicesd: What If Anyone Can Be You?</a>, <a href="https://mjtsai.com/blog/2017/12/20/explanation-of-homekit-vulnerability/">Explanation of HomeKit Vulnerability</a>.</p>
	</body>
</html>
